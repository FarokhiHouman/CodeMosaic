<UserControl x:Class="CodeMosaic.ListView"
             xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
             xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
             xmlns:local="clr-namespace:CodeMosaic"
             mc:Ignorable="d" 
             d:DesignHeight="500" d:DesignWidth="800">
	<UserControl.DataContext>
		<local:ListViewModel />
	</UserControl.DataContext>
	<UserControl.Resources>
		<!-- ItemTemplate for ListBox with CheckBox for multi-select -->
		<DataTemplate x:Key="ExtensionTemplate">
			<CheckBox Content="{Binding Extension}" IsChecked="{Binding IsSelected, Mode=TwoWay}" />
		</DataTemplate>
		<!-- Converter for JSON highlighting -->
		<local:JsonHighlightConverter x:Key="JsonHighlightConverter" />
	</UserControl.Resources>
	<Grid Margin="20">
		<Grid.RowDefinitions>
			<RowDefinition Height="Auto" />
			<RowDefinition Height="Auto" />
			<RowDefinition Height="Auto" />
			<RowDefinition Height="Auto" />
			<RowDefinition Height="*" />
			<RowDefinition Height="Auto" />
		</Grid.RowDefinitions>

		<!-- Source Folder Path Selection -->
		<StackPanel Grid.Row="0" Orientation="Horizontal" Margin="0,0,0,10">
			<TextBlock Text="Source Folder:" Width="100" VerticalAlignment="Center" />
			<TextBox Name="FolderPathTextBox" Text="{Binding FolderPath}" Width="400" Margin="5,0" />
			<Button Content="Browse" Width="80" Command="{Binding BrowseFolderCommand}" />
		</StackPanel>

		<!-- Output Folder and File Name -->
		<StackPanel Grid.Row="1" Orientation="Horizontal" Margin="0,0,0,10">
			<TextBlock Text="Output File:" Width="100" VerticalAlignment="Center" />
			<TextBox Name="OutputFolderTextBox" Text="{Binding OutputFolder}" Width="200" Margin="5,0" ToolTip="Output Folder" />
			<TextBox Name="OutputFileTextBox" Text="{Binding OutputFileName}" Width="150" Margin="5,0" ToolTip="File Name (JSON)" />
		</StackPanel>

		<!-- File Extensions Selection - Multi-Select with ListBox and Search -->
		<StackPanel Grid.Row="2" Orientation="Horizontal" Margin="0,0,0,10">
			<TextBlock Text="Extensions:" Width="100" VerticalAlignment="Center" />
			<TextBox Name="SearchExtensionsTextBox" Width="80" Margin="5,0" ToolTip="Search extensions" />
			<ListBox Name="ExtensionsListBox" ItemsSource="{Binding Extensions}" ItemTemplate="{StaticResource ExtensionTemplate}" Width="200" Height="80" Margin="5,0" ScrollViewer.VerticalScrollBarVisibility="Auto" />
			<TextBox Name="NewExtensionTextBox" Text="{Binding NewExtension}" Width="100" Margin="5,0" ToolTip="Add new extension (e.g., .xaml)" />
			<Button Content="Add" Width="60" Command="{Binding AddExtensionCommand}" />
		</StackPanel>

		<!-- Start List Button and New Feature Buttons -->
		<StackPanel Grid.Row="3" Orientation="Horizontal" HorizontalAlignment="Right">
			<Button Name="StartListButton" Content="Start List Files" Width="120" Height="30" Command="{Binding StartListCommand}" Margin="0,0,5,0" />
			<Button Content="Export CSV" Width="100" Height="30" Command="{Binding ExportCSVCommand}" ToolTip="Export list to CSV" />
			<Button Content="Detect Duplicates" Width="120" Height="30" Command="{Binding DetectDuplicatesCommand}" ToolTip="Highlight duplicates in list" />
			<Button Content="Batch Rename" Width="100" Height="30" Command="{Binding BatchRenameCommand}" ToolTip="Rename selected files with pattern" />
		</StackPanel>

		<!-- JSON Output Display with Highlighting -->
		<ScrollViewer Grid.Row="4" VerticalScrollBarVisibility="Auto">
			<ContentControl Content="{Binding JsonOutput, Converter={StaticResource JsonHighlightConverter}}" 
                            FontFamily="Consolas" 
                            FontSize="12" 
                            Padding="5" />
		</ScrollViewer>

		<!-- Status Label -->
		<TextBlock Grid.Row="5" Name="StatusTextBlock" Text="{Binding StatusMessage}" Foreground="Gray" HorizontalAlignment="Center" />
	</Grid>
</UserControl>